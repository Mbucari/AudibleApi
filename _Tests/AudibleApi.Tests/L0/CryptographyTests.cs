using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using Dinah.Core;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using Shouldly;

namespace CryptographyTests
{

	[TestClass]
	public class encryptMetadata
	{

		[TestMethod]
		public void EncryptMetadataTest()
		{
			StringBuilder sb = new();
			sb.Append('0', 4154);
			string metadata = sb.ToString();
			string expected = "ECdITeCs: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";
			var result = AudibleApi.Cryptography.Util.EncryptMetadata(metadata);
			result.ShouldBe(expected);
		}
	}
}
